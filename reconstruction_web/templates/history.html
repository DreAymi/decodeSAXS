<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>decodeSAXS-check</title>
    {% load staticfiles %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="{% static "./4/flatly/bootstrap.css" %}" media="screen">
    <link rel="stylesheet" href="{% static "./_assets/css/custom.min.css" %}">
    <link rel="stylesheet" href="{% static "./_vendor/bootstrap/dist/css/bootstrap-table.css" %}">
    <script>

     var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23019901-1']);
      _gaq.push(['_setDomainName', "bootswatch.com"]);
        _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

     (function() {
       var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
       ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
     })();

    </script>
  </head>
  <body>
    <div class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
      <div class="container">
        <a style="font-size: x-large" href="/index/" class="navbar-brand">decodeSAXS</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a style="font-size: large" class="nav-link" href="/index/">Home</a>
            </li>
            <li class="nav-item">
            <a style="font-size: large" class="nav-link" href="/submit/">Submit</a>
            </li>
            <li class="nav-item">
              <a style="font-size: large" class="nav-link" href="/check/">Check</a>
            </li>
            <li class="nav-item">
              <a style="font-size: large" class="nav-link" href="/history/">History</a>
            </li>
            <li class="nav-item">
              <a style="font-size: large" class="nav-link" href="/tutorial/">Tutorial</a>
            </li>
            <li><a style="font-size: large" class="nav-link" href="https://github.com/DreAymi/SAXS_reconstruction"><i aria-hidden="true"></i> GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>



    <div class="page-header" id="banner" style = "margin-left: 280px;margin-right: 280px">
        <div class="row">
          <div class="col-lg-8 col-md-7 col-sm-6">
            <h1>Submit History</h1>
          </div>
        </div>
        <hr></hr>
        <table id="listHistory">
        </table>
    </div>

<script src="{% static "./_vendor/jquery/dist/jquery.min.js" %}"></script>
<script src="{% static "./_vendor/bootstrap/dist/js/bootstrap.min.js" %}"></script>
<script src="{% static "./_vendor/bootstrap/dist/js/bootstrap-table.js" %}"></script>


<script>
    function gethistory()

     {
        $('#listHistory').bootstrapTable('destroy');
        $('#listHistory').bootstrapTable({
        url: '/checkhistory/',
        method: 'get',
        contentType:"application/x-www-form-urlencoded; charset=UTF-8", // 默认是：'application/json'， 不改的话，后台获取不到数据!

        cache: false,   //是否启用 数据缓存
        pagination: true,  //是都分页
        sidePageination: 'client',   //谁来分页，客户端：'client'，服务端：'server'
        pageNumber: 1,   //默认显示 首页
            pageSize: 10,     //每页需要显示的数据量
        pageList: [10, 25, 50],  //可供选择的，每页需要显示的数据量
        height: 600,       //表格高度
        uniqueId: 'job_ID',
        silent: true,    // 刷新服务器数据
        showExport: true,
        exportDataType: 'all',

        columns: [{
            field: 'job_ID',
            title: 'Job ID',
            valign: 'middle',
            align: 'center',
            halign: 'center'
        }, {
            field: 'status',
            title: 'status',
            valign: 'middle',
            align: 'center',
            halign: 'center'
        }, {
            field: 'downloadlink',
            title: 'click to download',
            valign: 'middle',
            align: 'center',
            halign: 'center',
            formatter:function(value,row,index) {
                if (value.length>1) {
                    var valuesplit = value.split(".");
                    var address = '../static/download/' + valuesplit[0] + '/' + value;
                    var returnhtml = "<a href=\"" + address + "\">download</a>"
                    return [
                        returnhtml
                    ].join("")
                }
                else {
                    return [
                        '<a href="#">wait...</a>'
                    ].join("")
                }
            }


        }],

        responseHandler: function(res) {   //处理 从后端 返回的数据
            console.log(res);
            if (res == 0) {
                alert('查询出问题！');
            } else {
                var orderListData = res['rows'];
                return orderListData;
            }
        },
        onLoadError: function (status) {
            console.log(status);
            $('#order_list').bootstrapTable('removeAll');
        }
        })
    }
    gethistory()

</script>

<div class="text" style=" text-align:center;margin-top: 120px">Building 9, East Zone, ZPark II, No.10 East Xibeiwang Road, Haidian District, Beijing 100193, China</div>
<div class="text" style=" text-align:center;">Department of Complex System</div>

</body>

</html>

